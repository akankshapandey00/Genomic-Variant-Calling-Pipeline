# Author 
### Akanksha Pandey

## Overview

Variant calling is the identification of genomic differences between individuals of the same species (germline) or differences between tissues in a single individual (somatic). The basic process for finding germline variation is to align NGS reads from an individual against the reference genome for the species producing a bam alignment file then to analyze the alignments using a variant calling program like DeepVariant (@DeepVar). The output is generally stored as a Variant Call Format, or vcf file. The process is basically the same for finding somatic variants, the key difference being that you are looking for genetic variation between the tissues of a single individual. A very important use for somatic variant calling is identifying mutations in cancer cells within a tumor. This information can help in the selection of the best treatment.

# Sequence Reads
## `getGenome.sh`
We download the reference genome for human, release 27 from the Gencode FTP server. The output SAM file contains read group information, including a unique identifier for the read group and a sample identifier. 

## `getReads.sh`
Retrieve the NGS reads from the NA12878 reference sample that are available in the SRA under accession SRR6808334. The downloaded file is saved as GRCh38_reference.fa.gz in the current directory


# Quality Control 
## `trimReads.sh`
Quality trim the reads using Trimmomatic. it used sliding window to determine when when quality trimming score has dropped below a specific threshold also removes adapter sequence, low-quality reads, and potential contaminants from the raw sequencing data from the reads. It supports both single-end and paired-end reads. The -n 19 command written in line 3 helps to set the priority of the Trimmomatic process to be lower than the default [@Tri]

# Alignment to Genome

Read alignment or mapping is performed to determine where in the genome our reads originated from. 

The Indexing the reference genome alignment process has two steps:

 1. Indexing the reference genome
 
 2.  Aligning the reads to the reference genome

## `indexGenome.sh`
We index the reference genome (GRCh38_reference.fa) for use by BWA. This allows the aligner to find potential alignment sites for query sequences in a genome fast, it saves time during alignment.

## `alignReads.sh`
Then we align the reads to reference genome. This is done by choosing an appropriate reference genome to map our reads against and then deciding on an aligner. We use BWA-MEM, which is part of BWA software package. It the latest and is generally recommended for high-quality queries as it is faster and more accurate.[@BW]

# Alignment Cleanup

## `sort.sh`
SAM file, is a tab-delimited text file and it contains information for each individual read and its alignment to the genome. The compressed binary version of SAM is called a BAM file. This reduces the size and allows indexing, which enables efficient random access of the data contained within the file. Hence, we convert Sam file to bam file. 

## `indexReads.sh`
This is used to index the bam file generated by sort.sh with the help of SAMtools. -b option specifies that the index file should be created in the BAM format. 

# Variant Calling 
## `runDeepVariant.sh`
Produce a VCF file using DeepVariant. DeepVariant is a deep learning-based variant caller that takes aligned reads present in the BAM file, produces pileup image tensors from them, classifies each tensor using a convolutional neural network, and finally reports the results in a standard VCF file. The scripts creates the necessary directory structure and downloads Docker, a containerization platform that allows DeepVariant to run in an isolated environment. It then copies the input data into the input directory, pulls the DeepVariant Docker image, and runs the DeepVariant program using the specified options. The scrpit produces two output files, a variant call format (VCF) file and a genome VCF (gVCF) file, which are stored in the output directory. [@DeepVar]

## References
Bolger, Anthony M., Marc Lohse, and Bjoern Usadel. 2014. “Trimmomatic: A Flexible Trimmer for Illumina Sequence Data.” *Bioinformatics* 30 (15): 2114–20..

Li, Heng, and Richard Durbin. 2009. “Fast and Accurate Short Read Alignment with Burrows-Wheeler Transform.” *Bioinformatics* 25 (14): 1754–60..

Poplin, Ryan, Pi-Chuan Chang, David Alexander, Scott Schwartz, Thomas Colthurst, Alexander Ku, Dan Newburger, et al. 2018. “A Universal SNP and Small-Indel Variant Caller Using Deep Neural Networks.” *Nature Biotechnology* 36 (September): 983..
